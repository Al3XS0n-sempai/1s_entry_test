# 1s_entry_test

Попалось мне довольно интересная задача.  
  
Необходимо на картинке найти все пересечения отрезков

---

Начнём со считывания картинки.  
Она даётся в формате png. Для считывания я использовал single-file public domain бибеотеку stb.  
Если быть точнее то её часть в виде: [stb_image.h](include/ImageReader/stb_image.h)  
Но так как вся библеотека написанная на C. То для использования необходимо написать небольшое заклинание:  
```c++
extern "C" {
    #define STB_IMAGE_IMPLEMENTATION
    #include "stb_image.h"
}
```
Хорошо, со считванием понятно. Что дальше?  
А дальше давайте преобразуем наше изображение к двоичному виду, где 1 это черный цвет а 0 - белый.

---
  
Теперь к решению задачи.  
1.  Для начала давайте решим частный случай конда у нас есть толлько вертикальные и горизонтальные линии. Тогда мы можем, сжать их до ширины в 1 пиксель(заметим что это никак ни повлиляет на факт их пересечения).  
    Это можно сделать используя к примеру алгоритм $scan-line$. При начале каждой новой прямой нужно посмотреть на её ширину и отступить половину от этого значения.  
    После этого все персечения будут иметь вид: 
```
010  
111  
010  
``` 

Их можно посчитать просто перебирая квадраты 3 на 3.  

2. Но это был только частный случай, добавим теперь к обычным прямым, наклонные. 
Не смотря на небольшое дополнение, это весь серьезно усложняет нам задачу тем, что мы теряем возможность сжать прямую до 1 пикселя, а так же стоновить сложнее искать пересечения.
Для начала давайте поймём, что если мы научимся хранить прямые не как единички на массиве, а как вполне определенный объект со своими параметрами(например концами координат или полярными координатами), то искать пересечения станет в разы прощё, так как мы сможем применить алгоритм поиска числа персечения на заданном массиве прямых(что кстати тоже делается с помощью $scan-line$'а).  
Вопрос в том как преобразовать толстые линим в массиве в набор из пар чисел. На этом этапе я перебрал несколько вариантов, но в процессе написания появлялись контрпримеры которые ломали все мои решения.  
В конце концов, я придумал оставить от прямых только их контуры, и работать с ними. Я брал контур и пытался пройти вдоль него, когда я упирался в контур другой прямой, я шёл насквозь пытаясь угадать как ведет себя прямая. И по началу это даже неплохо работало.  
Но довольно скоро я понял что из-за того что в процессе рисования очень часто могут возникать погрешности, моё решения считало лишние пересечения. Более того, я понял что угадывать напрваление прямой довольно трудно, так как прямая которая поначалу была прямой, может внезапно сдвигаться на пару пикселей. В итоге я удалил всё решение и сижу придумываю новое.  
UPD. Уже пол 8 но я так и не смог ничего нового придумать. Если интересно посмотреть на то как png превращается в 1-0 массив и от прямых остаются только контуры, то можно запустить код)) Это проект в Clion названине картики передаётся в аргументах программмы. Файл должен лежать в корневой директории проекта.